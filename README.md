# miRNACluster

Unsupervised microRNA clustering and comparison tool.

## Dependencies

```console
# Installs the binaries for BLAST, Clustal and MCL, and the scientific Python packages (scipy/numpy/pandas/sklearn)
sudo apt-get install ncbi-blast+-legacy clustalo mcl python3-scipy python3-numpy python3-pandas python3-sklearn
```

## Usage

```console
python miRNACluster.py [-h] [--file FILE] [--algorithms [ALGORITHMS [ALGORITHMS ...]]] [--cached [CACHED [CACHED ...]]] [--raw] 
```

Reads the miRBase input files, runs all the algorithms and obtains the statistical information from them. It also generates several output files to browse and compare the generated families.

## Features

It takes the miRBase miFam.dat, hairpin.fa and aliases.txt files from input/ directory and creates several ouput files in output/. The main three files are named miFamCentroid.dat, miFamGraph.dat and miFamDensity.dat, and correspond to the clustering generated by each algorithm.

The files follow the format of the miFam.dat file. The clusters are identified by IDs inferred from its members following a convention almost identical to the one used by miRBase, and they are assigned a sequential accession number.

Additional simplified "raw" files that facilitate comparison are generated for each algorithm and for the miRBase .dat file, using the _byname, _bysize, and _labelsonly suffixes for files ordered by cluster name, size, and with only cluster labels, respectively.

A file with the _equivalences suffix is generated to show the true-predicted cluster mappings used for that particular algorithm. Intermediate cache files are also generated for BLAST database formatting and alignment, Clustal algorithm output and MCL algorithm output. The clustering statistical information is displayed through the standard output.

The "cache" parameter allows to use existing generated files and avoid certain steps in the pipeline. Possible values are formatdb (BLAST-formatted database creation from the hairpin file), blast (BLAST all-to-all alignment), clustal (Clustal clustering file generation), mcl (MCL clustering file generation).

## Examples
Minimal usage (input/hairpin.fa as input, all algorithms, no cache, no raw files):
```console
python miRNACluster.py
```

Full parameter specification (input file, algorithms to run, use cache in all heavy steps, include raw files):
```console
python miRNACluster.py -i input/hairpin.fa -a centroid graph density -c formatdb blast clustal mcl -r
```

Print command usage:
```console
python miRNACluster.py -h
```

## Options
```console
-f [FILE [FILE ...]], --file [FILE [FILE ...]]
	The name of the dataset to cluster.
	[Default=hairpin.fa]
-a [ALGORITHMS [ALGORITHMS ...]], --algorithms [ALGORITHMS [ALGORITHMS ...]]
	List of algorithms to run (centroid/graph/density).
	[Default=all]
-c [CACHED [CACHED ...]], --cached [CACHED [CACHED ...]]
	List of steps where a cached file is assumed (formatdb/blast/clustal/mcl).
	[Default=none]
-r, --raw
	Include the raw files for miRNA families, useful for comparison.
    [Default=True]
-h, --help
	Shows a brief “usage” text of the command and exits
```

## Author
Samuel Acosta [samuel.acostamelgarejo AT postgrad.manchester.ac.uk]

## License
[GPLv3](https://choosealicense.com/licenses/gpl-3.0/)